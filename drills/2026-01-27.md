# Ruby/Rails ドリル復習 - 2026-01-27

## 第1問：Ruby文法・メソッド

**問題：**
```ruby
x = 10
[1, 2, 3].each do |x|
  # ブロック内の処理
end
p x
```

**選択肢：**
- A) `1`
- B) `3`
- C) `10`
- D) `nil`

**正解：** C

**解説：**
Ruby 1.9以降、ブロックパラメータはそのブロック内でのみ有効なローカル変数として扱われます。そのため、ブロック外の同名変数 `x` が書き換えられることはありません。

**公式リファレンス:**
- [変数と定数 - ローカル変数 (Ruby 3.3 リファレンスマニュアル)](https://docs.ruby-lang.org/ja/latest/doc/spec=2fvariable.html#local)

---

## 第2問：Rails規約・ヘルパー

**問題：**
Strong Parametersで使われるメソッドの組み合わせはどれですか？

**選択肢：**
- A) `allow` と `permit`
- B) `require` と `permit`
- C) `check` と `allow`
- D) `validate` と `permit`

**正解：** B

**解説：**
`require` で対象のキーを指定し、`permit` で許可する属性を指定します。

**公式リファレンス:**
- [Action Controller の概要 - Strong Parameters | Rails ガイド](https://railsguides.jp/action_controller_overview.html#strong-parameters)

---

## 第3問：よくあるミス・落とし穴

**問題：**
データベースに保存する直前に値を加工したい場合に最も適切なコールバックは？

**選択肢：**
- A) `after_save`
- B) `before_save`
- C) `after_create`
- D) `before_validation`

**正解：** B

**解説：**
`before_save` は新規作成および更新の両方で、データベースへの保存直前に実行されるため、値の加工に適しています。

**公式リファレンス:**
- [Active Record コールバック - 利用可能なコールバック | Rails ガイド](https://railsguides.jp/active_record_callbacks.html#%E5%88%A9%E7%94%A8%E5%8F%AF%E8%83%BD%E3%81%AA%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%9C%E3%83%83%E3%82%AF)

---

## 結果

**正解数：** 2/3

**今日のポイント：**
1. ブロックパラメータはブロック外の変数に影響しない（シャドウイング）
2. Strong Parametersは `require` と `permit`
3. 保存前のデータ加工は `before_save`
