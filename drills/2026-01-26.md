# Ruby/Rails ドリル復習 - 2026-01-26

## 第1問：Ruby文法・メソッド

**問題：**
```ruby
arr = [1, 2, 3, 4, 5]
result = arr.map { |n| n * 2 if n.odd? }
p result
```

**選択肢：**
- A) `[2, nil, 6, nil, 10]`
- B) `[2, 6, 10]`
- C) `[1, 3, 5]`
- D) エラーになる

**正解：** A

**解説：**
`map`メソッドは必ず元の配列と同じ要素数の配列を返す。`if`文が`false`の場合は`nil`を返すため、偶数の位置には`nil`が入る。

**補足：**
奇数だけを抽出したい場合は：
- `arr.select(&:odd?).map { |n| n * 2 }`
- `arr.map { |n| n * 2 if n.odd? }.compact`
- `arr.filter_map { |n| n * 2 if n.odd? }` (Ruby 2.7+)

---

## 第2問：Rails規約・ヘルパー

**問題：**
```ruby
# config/routes.rb
resources :articles do
  member do
    post :publish
  end
end
```

この`publish`アクションへのパスを生成するヘルパーメソッドは？

**選択肢：**
- A) `publish_article_path(@article)`
- B) `article_publish_path(@article)`
- C) `publish_articles_path(@article)`
- D) `articles_publish_path(@article)`

**正解：** A

**解説：**
`member`ブロック内のカスタムアクションは、命名規則が`[アクション名]_[リソース名単数形]_path`となる。

**補足：**
- **member**: 特定の1つのリソースに対する操作（単数形）
- **collection**: 全体に対する操作（複数形）

例：
- member → `publish_article_path(@article)` → `/articles/:id/publish`
- collection → `archived_articles_path` → `/articles/archived`

---

## 第3問：よくあるミス・落とし穴

**問題：**
```ruby
def greet(name, message = "Hello")
  puts "#{message}, #{name}!"
end

greet("Alice", message: "Hi")
```

**選択肢：**
- A) `Hi, Alice!` と出力される
- B) `Hello, Alice!` と出力される
- C) エラーになる
- D) `{:message=>"Hi"}, Alice!` と出力される

**正解：** D

**解説：**
メソッド定義は位置引数+デフォルト値だが、呼び出し時の`message: "Hi"`はハッシュとして解釈される。
- `name` = `"Alice"`
- `message` = `{:message=>"Hi"}`（ハッシュ全体）

**正しい書き方：**

位置引数として渡す：
```ruby
greet("Alice", "Hi")  # => "Hi, Alice!"
```

キーワード引数を使う（推奨）：
```ruby
def greet(name, message: "Hello")  # コロンを後ろに
  puts "#{message}, #{name}!"
end

greet("Alice", message: "Hi")  # => "Hi, Alice!"
```

---

## 結果

**正解数：** 1/3

**今日のポイント：**
1. `map`は必ず元の配列と同じ要素数を返す
2. Railsのmemberルートは`[アクション]_[単数形]_path`
3. キーワード引数は定義時に`name:`、位置引数は`name = 値`
